<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fetch &amp; Process Results • formr</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fetch &amp; Process Results">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">formr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/getting-started.html">Getting Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><h6 class="dropdown-header" data-toc-skip>Basics</h6></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Project Management</h6></li>
    <li><a class="dropdown-item" href="../articles/manage-your-studies.html">Manage your Studies (Workflow)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Run Administration</h6></li>
    <li><a class="dropdown-item" href="../articles/manage-your-runs.html">Manage your Runs</a></li>
    <li><a class="dropdown-item" href="../articles/manage-your-sessions.html">Manage your Sessions</a></li>
    <li><a class="dropdown-item" href="../articles/manage-your-surveys.html">Manage your Surveys</a></li>
    <li><a class="dropdown-item" href="../articles/manage-your-files.html">Manage your Files</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/fetch-and-process-results.html">Fetch &amp; Process Results</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rubenarslan/formr" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fetch &amp; Process Results</h1>
            
      

      <div class="d-none name"><code>fetch-and-process-results.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rubenarslan.github.io/formr/">formr</a></span><span class="op">)</span></span></code></pre></div>
<p>One of the strongest features of the <code>formr</code> package is
the ability to create a reproducible data import pipeline. Instead of
manually downloading CSVs from a website, renaming columns, and
calculating scales in a messy script, you can fetch, merge, and clean
your data in a few lines of code.</p>
<div class="section level2">
<h2 id="fetching-data">1. Fetching Data<a class="anchor" aria-label="anchor" href="#fetching-data"></a>
</h2>
<p>The primary function for retrieving data is
<code><a href="../reference/formr_results.html">formr_results()</a></code>.</p>
<div class="section level3">
<h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<p>By default, <code>formr_results</code> fetches all the surveys
currently in use and all the shuffle units ever associated with a
run.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch all data for a run</span></span>
<span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_results.html">formr_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span><span class="op">)</span></span></code></pre></div>
<p>If your run contains multiple surveys (e.g., a “Baseline” and a
“Diary”), the function returns a <strong>named list</strong> of tibbles,
one for each survey.</p>
</div>
<div class="section level3">
<h3 id="automatic-joining-join-true">Automatic Joining (<code>join = TRUE</code>)<a class="anchor" aria-label="anchor" href="#automatic-joining-join-true"></a>
</h3>
<p>In most analysis scenarios, you want a single “wide” dataset where
one row represents one session. Setting <code>join = TRUE</code> handles
this automatically.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch and merge everything by session ID</span></span>
<span><span class="va">joined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_results.html">formr_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span>, join <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>What happens during the join?</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Merging:</strong> Surveys are full-joined by the
<code>session</code> identifier.</li>
<li>
<strong>Conflict Resolution:</strong> If variable names collide
(e.g., both surveys have a variable named <code>created</code>), they
are suffixed with the survey name (e.g., <code>created_baseline</code>,
<code>created_diary</code>).</li>
<li>
<strong>Shuffles:</strong> If your run uses randomization
(Shuffles), the group assignments are automatically pivoted wide. For
example, if a user was assigned to “Group A” in unit 10, you will get a
column <code>shuffle_10</code> with the value “Group A”.</li>
</ol>
</div>
<div class="section level3">
<h3 id="server-side-filtering">Server-Side Filtering<a class="anchor" aria-label="anchor" href="#server-side-filtering"></a>
</h3>
<p>If your study is large-scale, involving thousands of participants,
variables, and repetitions, you may want to only retrieve the data you
need to save bandwidth and memory. This would also be the preferred way
to get just the items that interest you when accessing results within
your form run.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch only specific surveys</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_results.html">formr_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span>, surveys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"survey_1"</span>, <span class="st">"survey_2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch specific items (columns)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_results.html">formr_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span>, item_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"gender"</span>, <span class="st">"extraversion_1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-processing-pipeline">2. The Processing Pipeline<a class="anchor" aria-label="anchor" href="#the-processing-pipeline"></a>
</h2>
<p>Statistical analysis of raw data from the server often requires
further processing.</p>
<p>The <code><a href="../reference/formr_post_process_results.html">formr_post_process_results()</a></code> function transforms
this raw data into an analysis-ready format using the study’s
metadata.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The "Magic" Command</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_post_process_results.html">formr_post_process_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span><span class="op">)</span></span></code></pre></div>
<p>This single function wrapper performs four major steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Fetches Metadata:</strong> It downloads the survey
properties (item types, choice lists) to know <em>how</em> to process
the data.</li>
<li>
<strong>Type Recognition:</strong> Converts strings to Dates, and
choice-based numbers to Factors with correct labels.</li>
<li>
<strong>Reverse Coding:</strong> Automatically reverses items ending
in <code>R</code>.</li>
<li>
<strong>Aggregation:</strong> Automatically computes mean scores for
scale items.</li>
</ol>
<div class="section level3">
<h3 id="step-by-step-breakdown">Step-by-Step Breakdown<a class="anchor" aria-label="anchor" href="#step-by-step-breakdown"></a>
</h3>
<p>If you prefer manual control, you can run these steps
individually.</p>
<div class="section level4">
<h4 id="a--type-recognition-formr_recognise">A. Type Recognition (<code>formr_recognise</code>)<a class="anchor" aria-label="anchor" href="#a--type-recognition-formr_recognise"></a>
</h4>
<p>Uses the item metadata to assign classes.</p>
<ul>
<li>
<strong>Choice items:</strong> Converted to
<code>haven_labelled</code> or factors. Labels (e.g., “Strongly Agree”)
are attached to values (e.g., 5).</li>
<li>
<strong>Dates:</strong> Converted to <code>POSIXct</code>.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manual Type Recognition</span></span>
<span><span class="va">items_nested</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_run_structure.html">formr_run_structure</a></span><span class="op">(</span><span class="st">"my-study-name"</span><span class="op">)</span> <span class="co"># Get metadata</span></span>
<span><span class="va">items_flat</span> <span class="op">&lt;-</span> <span class="fu">formr</span><span class="fu">:::</span><span class="fu">.extract_items_from_run</span><span class="op">(</span><span class="va">items_nested</span><span class="op">)</span></span>
<span><span class="va">raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_results.html">formr_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span>, join <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Get data</span></span>
<span></span>
<span><span class="va">step1_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_recognise.html">formr_recognise</a></span><span class="op">(</span>item_list <span class="op">=</span> <span class="va">items_flat</span>, results <span class="op">=</span> <span class="va">raw</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b--reverse-coding-formr_reverse">B. Reverse Coding (<code>formr_reverse</code>)<a class="anchor" aria-label="anchor" href="#b--reverse-coding-formr_reverse"></a>
</h4>
<p>Looks for items ending in <code>R</code> (e.g.,
<code>neuroticism_3R</code>). It determines the minimum and maximum
possible values from the survey metadata (the “choices” list) and
applies the formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">New</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Max</mtext><mo>+</mo><mtext mathvariant="normal">Min</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mtext mathvariant="normal">Old</mtext></mrow><annotation encoding="application/x-tex">\text{New} = (\text{Max} + \text{Min}) - \text{Old}</annotation></semantics></math></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manual Reverse Coding</span></span>
<span><span class="va">step2_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_reverse.html">formr_reverse</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">step1_data</span>, item_list <span class="op">=</span> <span class="va">items_flat</span><span class="op">)</span></span></code></pre></div>
<p><em>Note: Attributes are added to the column (e.g.,
<code>reversal_const</code>) so you can verify the
transformation.</em></p>
</div>
<div class="section level4">
<h4 id="c--aggregation-formr_aggregate">C. Aggregation (<code>formr_aggregate</code>)<a class="anchor" aria-label="anchor" href="#c--aggregation-formr_aggregate"></a>
</h4>
<p>Calculates mean scores for items sharing a common “stem”. For
example, if you have <code>extra_1</code>, <code>extra_2</code>, and
<code>extra_3R</code>, the function detects the stem <code>extra</code>,
calculates the row-mean, and creates a new column
<code>extra</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manual Aggregation</span></span>
<span><span class="va">step3_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_aggregate.html">formr_aggregate</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">step2_data</span>, item_list <span class="op">=</span> <span class="va">items_flat</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="handling-test-sessions">3. Handling Test Sessions<a class="anchor" aria-label="anchor" href="#handling-test-sessions"></a>
</h2>
<p>By default, <code>formr_post_process_results</code> removes test
sessions (sessions containing “XXX” in their code). You can keep them if
you are debugging:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep test users</span></span>
<span><span class="va">debug_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/formr_post_process_results.html">formr_post_process_results</a></span><span class="op">(</span><span class="st">"my-study-name"</span>, remove_test_sessions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ruben Arslan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
